<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animus ONG - Ajude um Animal Carente</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🐾</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8D5B4C; /* Marrom quente e acolhedor */
            --secondary-color: #E4C59E; /* Bege claro e amigável */
            --accent-color: #D88C9A; /* Rosa/coral para destaque */
            --text-color: #433633;
            --bg-color: #FDF8F5;
            --white: #FFFFFF;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }

        /* Header */
        header {
            background-color: var(--white);
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky; top: 0; z-index: 1000;
        }
        header .container { display: flex; justify-content: space-between; align-items: center; }
        .logo { color: var(--primary-color); font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 1.5rem; text-decoration: none; }
        .logo span { color: var(--accent-color); }
        nav { display: flex; align-items: center; gap: 30px; }
        nav a { text-decoration: none; color: var(--text-color); font-weight: 600; font-size: 1rem; transition: color 0.3s ease; }
        nav a:hover { color: var(--primary-color); }
        #user-auth { display: flex; align-items: center; gap: 10px; min-width: 120px; justify-content: flex-end; }
        #user-auth img { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--primary-color); }
        #btn-logout { background-color: var(--accent-color); color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer; border: none; font-weight: 600; }

        /* Hero Section */
        .hero { text-align: center; padding: 100px 20px; background: url('https://images.unsplash.com/photo-1548681528-6a5c45b66b42?q=80&w=1974&auto=format&fit=crop') no-repeat center center/cover; background-color: rgba(0,0,0,0.5); background-blend-mode: multiply; color: var(--white); display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 70vh; }
        .hero h1 { font-family: 'Montserrat', sans-serif; font-size: 3.5rem; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .hero p { font-size: 1.25rem; max-width: 650px; margin: 0 auto 40px; }
        .btn { display: inline-block; background-color: var(--accent-color); color: var(--white); padding: 15px 35px; border-radius: 50px; text-decoration: none; font-weight: 700; transition: all 0.3s ease; border: none; cursor: pointer; font-family: 'Poppins', sans-serif; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(216, 140, 154, 0.5); }

        /* Sections */
        section { padding: 80px 0; }
        section h2 { font-family: 'Montserrat', sans-serif; text-align: center; font-size: 2.8rem; margin-bottom: 60px; color: var(--primary-color); }
        #doacao { background-color: var(--white); }

        /* Donation Section */
        .donation-box { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: flex-start; }
        .donation-controls h3, .qr-code-box h3 { margin-bottom: 20px; color: var(--primary-color); font-size: 1.5rem; }
        .donation-amounts { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .donation-amounts button { font-size: 1.1rem; padding: 15px; border: 2px solid var(--secondary-color); background: none; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-weight: 600; }
        .donation-amounts button.selected, .donation-amounts button:hover { background-color: var(--primary-color); color: var(--white); border-color: var(--primary-color); }
        .custom-amount { width: 100%; font-size: 1.1rem; padding: 15px; border-radius: 8px; border: 2px solid var(--secondary-color); font-family: 'Poppins', sans-serif; }
        .qr-code-box { text-align: center; background: #f9f9f9; padding: 30px; border-radius: 12px; }
        #qrcode { display: flex; justify-content: center; align-items: center; background-color: var(--white); width: 220px; height: 220px; margin: 20px auto; padding: 10px; border: 1px solid #ddd; border-radius: 10px; }
        #pix-code { width: 100%; padding: 10px; font-size: 0.9rem; background-color: #f0f0f0; border: 1px solid #ccc; border-radius: 5px; margin-top: 15px; word-wrap: break-word; cursor: pointer; text-align: center; resize: none; }
        .btn-claim { background-color: var(--primary-color); width: 100%; margin-top: 20px; font-size: 1rem; padding: 15px; }

        /* Ranking & Team */
        #ranking { background-color: #FDF8F5; }
        #time { background-color: var(--white); }
        .ranking-list, .team-grid { max-width: 800px; margin: 0 auto; }
        .ranking-list { list-style: none; }
        .ranking-list li { display: flex; align-items: center; background: var(--white); padding: 15px 25px; border-radius: 15px; margin-bottom: 15px; box-shadow: var(--shadow); transition: transform 0.2s; }
        .ranking-list li:hover { transform: scale(1.02); }
        .rank-pos { font-size: 1.5rem; font-weight: 700; color: var(--accent-color); min-width: 50px; }
        .rank-img { width: 50px; height: 50px; border-radius: 50%; margin-right: 20px; object-fit: cover; }
        .rank-name { font-weight: 600; font-size: 1.2rem; flex-grow: 1; }
        .rank-amount { font-weight: 700; font-size: 1.3rem; color: var(--primary-color); }
        .team-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .team-member { text-align: center; }
        .team-member img { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 5px solid var(--secondary-color); margin-bottom: 15px; }
        .team-member h4 { font-family: 'Montserrat', sans-serif; font-size: 1.4rem; margin-bottom: 5px; }

        /* Footer */
        footer { text-align: center; padding: 30px 0; background-color: var(--secondary-color); }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            section h2 { font-size: 2.2rem; }
            .donation-box { grid-template-columns: 1fr; gap: 40px; }
            .qr-code-box { padding: 20px; }
            nav { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <a href="#" class="logo">Animus<span>.</span>ONG</a>
            <nav>
                <a href="#doacao">Doar Agora</a>
                <a href="#ranking">Hall dos Heróis</a>
                <a href="#time">Nosso Time</a>
            </nav>
            <div id="user-auth">
                </div>
        </div>
    </header>

    <main>
        <section class="hero">
            <h1>Cada vida importa.</h1>
            <p>Sua doação se transforma em ração, medicamentos e esperança para centenas de animais em Senador Pompeu - CE. Ajude a Animus ONG a continuar este trabalho.</p>
            <a href="#doacao" class="btn">QUERO AJUDAR AGORA</a>
        </section>

        <section id="doacao">
            <div class="container">
                <h2>Faça sua Doação</h2>
                <div class="donation-box">
                    <div class="donation-controls">
                        <h3>1. Escolha ou digite um valor</h3>
                        <div class="donation-amounts">
                            <button data-amount="10">R$ 10</button>
                            <button data-amount="25">R$ 25</button>
                            <button data-amount="50">R$ 50</button>
                            <button data-amount="100">R$ 100</button>
                        </div>
                        <input type="number" id="custom-amount" class="custom-amount" placeholder="Ou digite outro valor (ex: 15.50)">
                    </div>
                    <div class="qr-code-box">
                        <h3>2. Pague com PIX</h3>
                        <div id="qrcode"></div>
                        <p><strong>Chave PIX (E-mail):</strong> onganimus@gmail.com</p>
                        <textarea id="pix-code" readonly rows="3" title="Clique para copiar o código PIX"></textarea>
                        <button class="btn btn-claim" id="btn-claim">Já doei! Quero ir para o ranking</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="ranking">
            <div class="container">
                <h2>Hall dos Heróis</h2>
                <ol class="ranking-list" id="ranking-list-container">
                    <p style="text-align:center;">Carregando ranking...</p>
                </ol>
            </div>
        </section>
        
        <section id="time">
            <div class="container">
                <h2>Nosso Time</h2>
                <div class="team-grid">
                    <div class="team-member">
                        <img src="https://via.placeholder.com/150/D88C9A/FFFFFF?text=CC" alt="Foto Cynthia Carvalho">
                        <h4>Cynthia Carvalho</h4>
                        <p>Fundadora e Presidente</p>
                    </div>
                    <div class="team-member">
                        <img src="https://via.placeholder.com/150/8D5B4C/FFFFFF?text=JS" alt="Foto Jardeson">
                        <h4>Jardeson</h4>
                        <p>Coordenador de Voluntários</p>
                    </div>
                    <div class="team-member">
                        <img src="https://via.placeholder.com/150/E4C59E/433633?text=LV" alt="Foto Membro 3">
                        <h4>Dr(a) Silva</h4>
                        <p>Veterinário(a) Responsável</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Animus ONG. Todos os direitos reservados.</p>
            <p>Senador Pompeu - Ceará</p>
        </div>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.16.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.16.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.16.0/firebase-auth-compat.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // =======================================================
            // CONFIGURAÇÃO FINAL E CORRETA DO SEU NOVO PROJETO FIREBASE
            // =======================================================
            const firebaseConfig = {
                apiKey: "AIzaSyCKA4nxvDR3IrVcrvBVwLNPoUepjPPM",
                authDomain: "ong-animus-oficial.firebaseapp.com",
                projectId: "ong-animus-oficial",
                storageBucket: "ong-animus-oficial.appspot.com",
                messagingSenderId: "387798837633",
                appId: "1:387798837633:web:c4837caabffb87f44a6b8f",
                measurementId: "G-3L1K94H8EC"
            };
            
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            const auth = firebase.auth();

            // =======================================================
            // LÓGICA DE DOAÇÃO PIX
            // =======================================================
            const pixKey = "onganimus@gmail.com";
            const merchantName = "Animus ONG";
            const merchantCity = "SENADOR POMPEU";
            let selectedAmount = 25.00;
            const qrcodeContainer = document.getElementById('qrcode');
            const pixCodeTextarea = document.getElementById('pix-code');
            let qr;

            function generatePIXPayload(key, amount, name, city) {
                const formattedAmount = amount.toFixed(2);
                const payload = [
                    '000201', '26' + (key.length + 18).toString().padStart(2, '0') + '0014br.gov.bcb.pix01' + key.length.toString().padStart(2, '0') + key,
                    '52040000', '5303986', '54' + formattedAmount.length.toString().padStart(2, '0') + formattedAmount,
                    '5802BR', '59' + name.slice(0, 25).length.toString().padStart(2, '0') + name.slice(0, 25),
                    '60' + city.slice(0, 15).length.toString().padStart(2, '0') + city.slice(0, 15),
                    '62070503***'
                ].join('');
                let crc16 = 0xFFFF;
                const fullPayload = payload + '6304';
                for (let i = 0; i < fullPayload.length; i++) {
                    crc16 ^= fullPayload.charCodeAt(i) << 8;
                    for (let j = 0; j < 8; j++) {
                        crc16 = (crc16 & 0x8000) ? (crc16 << 1) ^ 0x1021 : crc16 << 1;
                    }
                }
                const crc16Hex = (crc16 & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
                return fullPayload + crc16Hex;
            }

            function updateQRCode(amount) {
                if(!qr) {
                    qr = new QRCode(qrcodeContainer, { width: 200, height: 200, colorDark: "#433633", colorLight: "#FFFFFF" });
                }
                const payload = generatePIXPayload(pixKey, amount, merchantName, merchantCity);
                qr.makeCode(payload);
                pixCodeTextarea.value = payload;
                pixCodeTextarea.onclick = () => { 
                    navigator.clipboard.writeText(payload)
                        .then(() => alert('Código PIX copiado com sucesso!'))
                        .catch(err => alert('Falha ao copiar o código.'));
                };
            }
            
            const amountButtons = document.querySelectorAll('.donation-amounts button');
            const customAmountInput = document.getElementById('custom-amount');

            amountButtons.forEach(button => {
                button.addEventListener('click', () => {
                    amountButtons.forEach(btn => btn.classList.remove('selected'));
                    button.classList.add('selected');
                    selectedAmount = parseFloat(button.dataset.amount);
                    customAmountInput.value = '';
                    updateQRCode(selectedAmount);
                });
            });
            
            customAmountInput.addEventListener('input', () => {
                amountButtons.forEach(btn => btn.classList.remove('selected'));
                const customValue = parseFloat(customAmountInput.value.replace(',', '.'));
                if (!isNaN(customValue) && customValue > 0) {
                    selectedAmount = customValue;
                    updateQRCode(selectedAmount);
                }
            });
            
            document.querySelector('.donation-amounts button[data-amount="25"]').classList.add('selected');
            updateQRCode(selectedAmount);

            // =======================================================
            // LÓGICA DE AUTENTICAÇÃO E RANKING
            // =======================================================
            const userAuthContainer = document.getElementById('user-auth');

            auth.onAuthStateChanged(user => {
                if (user) {
                    userAuthContainer.innerHTML = `
                        <span>Olá, ${user.displayName.split(' ')[0]}</span>
                        <img src="${user.photoURL}" alt="Foto de perfil" title="${user.displayName}">
                        <button id="btn-logout">Sair</button>
                    `;
                    document.getElementById('btn-logout').addEventListener('click', () => auth.signOut());
                } else {
                    userAuthContainer.innerHTML = `<button class="btn" id="btn-login" style="padding: 10px 25px;">Login com Google</button>`;
                    document.getElementById('btn-login').addEventListener('click', signInWithGoogle);
                }
            });

            function signInWithGoogle() {
                const provider = new firebase.auth.GoogleAuthProvider();
                auth.signInWithPopup(provider).catch(error => console.error("Erro no login:", error));
            }

            document.getElementById('btn-claim').addEventListener('click', () => {
                const user = auth.currentUser;
                if (!user) {
                    alert("Por favor, faça o login com Google primeiro para registrar sua doação no ranking.");
                    signInWithGoogle();
                    return;
                }
                const donatedAmountStr = prompt("Obrigado por doar! Para entrar no ranking, por favor, confirme o valor que você doou (use ponto para centavos, ex: 25.50):");
                if (donatedAmountStr) {
                    const donatedAmount = parseFloat(donatedAmountStr.replace(',', '.'));
                    if (!isNaN(donatedAmount) && donatedAmount > 0) {
                        const donationData = {
                            userId: user.uid,
                            userName: user.displayName,
                            userPhoto: user.photoURL,
                            amount: donatedAmount,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                            status: 'pending_verification'
                        };
                        db.collection('donations').add(donationData)
                            .then(() => {
                                alert("Sua doação foi registrada! Ela aparecerá no ranking assim que for verificada pela nossa equipe. Muito obrigado!");
                            })
                            .catch(error => console.error("Erro ao registrar doação:", error));
                    } else {
                        alert("Valor inválido. Por favor, digite apenas números.");
                    }
                }
            });

            async function displayRanking() {
                const rankingListContainer = document.getElementById('ranking-list-container');
                try {
                    const snapshot = await db.collection('donations').where('status', '==', 'verified').get();
                    if (snapshot.empty) {
                        rankingListContainer.innerHTML = '<p style="text-align:center;">Nossos heróis ainda estão se aquecendo. Seja o primeiro a aparecer aqui!</p>';
                        return;
                    }
                    const donationsByUser = {};
                    snapshot.docs.forEach(doc => {
                        const data = doc.data();
                        if (!donationsByUser[data.userId]) {
                            donationsByUser[data.userId] = { total: 0, name: data.userName, photo: data.userPhoto };
                        }
                        donationsByUser[data.userId].total += data.amount;
                    });
                    const rankedUsers = Object.values(donationsByUser).sort((a, b) => b.total - a.total).slice(0, 10);

                    rankingListContainer.innerHTML = '';
                    rankedUsers.forEach((user, index) => {
                        const listItem = document.createElement('li');
                        listItem.innerHTML = `
                            <span class="rank-pos">#${index + 1}</span>
                            <img src="${user.photo}" alt="Foto de ${user.name}" class="rank-img">
                            <span class="rank-name">${user.name}</span>
                            <span class="rank-amount">R$ ${user.total.toFixed(2).replace('.', ',')}</span>
                        `;
                        rankingListContainer.appendChild(listItem);
                    });
                } catch (error) {
                    console.error("Erro ao carregar o ranking:", error);
                    rankingListContainer.innerHTML = '<p style="text-align:center; color:red;">Não foi possível carregar o Hall de Heróis. Verifique as regras de segurança do Firestore.</p>';
                }
            }
            
            displayRanking();
        });
    </script>
</body>
</html>
